fetch(
    'https://opentdb.com/api.php?amount=10&category=9&difficulty=easy&type=multiple'
)
    .then((res) => {
        return res.json();
    })
    .then((loadedQuestions) => {
        questions = loadedQuestions.results.map((loadedQuestion) => {
            const formattedQuestion = {
                question: loadedQuestion.question,
            };

            const answerChoices = [...loadedQuestion.incorrect_answers];
            formattedQuestion.answer = Math.floor(Math.random() * 4) + 1;
            answerChoices.splice(
                formattedQuestion.answer - 1,
                0,
                loadedQuestion.correct_answer
            );

            answerChoices.forEach((choice, index) => {
                formattedQuestion['choice' + (index + 1)] = choice;
            });

            return formattedQuestion;
        });

        startGame();
    })
    .catch((err) => {
        console.error(err);
    });



---
var xhr = getXhr();
console.log("test1");
let jsondata = loadTopicPage();
console.log("test2");

function loadTopicPage() {
    console.log("loadTopic1");
    return sendXhr("GET", url);
}

function getXhr() 
{
    // API fÃ¼r asynchrone Aufrufe
    if (window.XMLHttpRequest) 
    {
        var xhr = new XMLHttpRequest();
        return xhr;
    } else return false;
}

function sendXhr(method, url) 
{
    console.log("sendXhr1");
    xhr.onreadystatechange = xhrHandler();
    xhr.open(method, url);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.setRequestHeader(
    "Authorization",
    "Basic " + window.btoa(username + ":" + password)
    );
    console.log("Hallo");
    xhr.send();
    console.log(xhr.responseText);
    console.log("sendXhr2");
}

function xhrHandler() 
{
    if (xhr.readyState == 4 && xhr.status == 200) 
        {
            console.log("Sindwirhier?");
            let jsondata = JSON.parse(xhr.responseText);
            logdata(jsondata);
            return jsondata;
        }
}




fetch(url, {
    method: 'get', // Default is 'get'
    mode: 'cors',
    headers: new Headers({
      'Content-Type': 'application/json',
      "Authorization": "Basic " + window.btoa(username + ":" + password)
    })
  })
  .then(response => response.json())
  
    //.then(response => response.json())
    .then((loadedQuestions) => {
        console.log(loadedQuestions);
        questions = loadedQuestions.content.map(( loadedQuestion) => {
            const formattedQuestion = {
                question: loadedQuestion.text
            };

            const answerChoices = [... loadedQuestion.options];
            counter +=1;

            answerChoices.forEach((choice, index)  => {
                formattedQuestion["choice" + (index+1)] = choice;
            })

            return formattedQuestion;
        })
        console.log(questions);
        //questions = loadedQuestions.options;
        //startGame();
    })
    .then(questions => test = questions)
    .then(() =>  console.log(test)) 
    .catch((err) => {
        console.error(err);
    });